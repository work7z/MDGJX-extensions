<html>
<body>

<h3>函数功能</h3>该函数从限定的可执行文件；动态链接库（DLL），或者图标文件中生成图标句柄数组。<br>
<h3>函数原型</h3>UINT EXtractlcohEX（LPCTSTR IpSZFile，int nlconlndex,HICON FAR*PhiCORLarge，HICON FAR'*phiconSmall,UINT nlcons）；<br>
<h3>参数</h3>
IpszFile:定义可获取图标的可执行文件，DLL,或者图标文件的名字的空结束字符串指针。<br>
nlconlndex:指定抽取第一个图标基于零的变址；例如，如果该值是零；函数在限定的文件中抽取第一图标；如该值是C1且phlconLarge和phiconSmall参数均为NULL，函数返回限定文件中图标的总数；如果文件是可执行文件或DLL；返回值是RT_GROUP_ICON资源的数目；如果文件是一个ICO文件，返回值是1；在Windows95，WindowsNT4.0,和更高版本中，如果值为负数且phlconLarge和phiconSmall均不为NULL，函数从获取图标开始，该图标的资源标识符等于nlconlndex绝对值。例如，使用-3来获取资源标识符为3的图标。<br>
phiconLarge:指向图标句柄数组的指针，它可接收从文件获取的大图标的句柄。如果该参数是NULL没有从文件抽取大图标。<br>
phiconSmall：指向图标句柄数组的指针，它可接收从文件获取的小图标的句柄。如果该参数是NULL，没有从文件抽取小图标。<br>
nlcons:指定要从文件中抽取图标的数目。<br>
<h3>返回值</h3>如果nlconlndex参数是-1，PhiconLarge和PhiconSmall参数是NULL，返回值是包含在指定文件中的图标数目；否则，返回值是成功地从文件中获取图标的数目。<br>
备注：必须调用Destroylcon函数来清除由ExtractlconEx函数返回的图标。为恢复大小图标尺寸,可使用SM_CXICON,SM_CYICON,SM_CXSMICON,SM_CYSMICON标记来调用GetSystemMetrics函数。<br>
Windows CE：nlconlndex参数必须是零或CN（N是指定的资源标识符）；nlcons参数必须是1。<br>
<h3>速查</h3>Windows NT：3.1及以上版本；Windows：95及以上版本；Windows CE：1.0及以上版本；头文件：shellspi.h；库文件：shell32.lib；Unicodg：在Windows NT上实现为Unicode和ANSI两种版本。<br>

</body>
</html>
