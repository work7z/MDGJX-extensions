<html>
<body>

<h3>函数功能</h3>该函数创建、显示、和操作一个消息框。消息框含有应用程序定义的消息和标题，加上预定义图标与Push（下按）按钮的任何组合。<br>
<h3>函数原型</h3>int MessageBox(HWND hWnd,LPCTSTR IpCaption,UINT UType);<br>
<h3>参数</h3>
hWnd:标识将被创建的消息框的拥有窗口。如果此参数为NULL，则消息框没有拥有窗口。<br>
IpText：指向一个以NULL结尾的、含有将被显示的消息的字符串的指针。<br>
IpCaption：指向一个以NULL结尾的、用于对话框标题的字符串的指针。<br>
uType：指定一个决定对话框的内容和行为的位标志集。此参数可以为下列标志组中标志的组合。<br>
指定下列标志中的一个来显示消息框中的按钮，标志的含义如下。<br>
MB_ABORTRETRYIGNORE：消息框含有三个按钮：Abort，Retry和Ignore。<br>
MB_OK：消息框含有一个按钮：OK。这是缺省值。<br>
MB_OKCANCEL：消息框含有两个按钮：OK和Cancel。<br>
MB_RETRYCANCEL：消息框含有两个按钮：Retry和Cancel。<br>
MB_YESNO：消息框含有两个按钮：Yes和No。<br>
MB_YESNOCANCEL：消息框含有三个按钮：Yes，No和Cancel。<br>
指定下列标志中的一个来显示消息框中的图标：标志的含义如下。<br>
MB_ICONEXCLAMATION:<br>
MB_ICONWARNING：一个惊叹号出现在消息框。<br>
MB_ICONINFORMATION：<br>
MB_ICONASTERISK：一个圆圈中小写字母i组成的图标出现在消息框。<br>
MB_ICONOUESTION:一个问题标记图标出现在消息框。<br>
MB_ICONSTOP:<br>
MB_ICONERROR：<br>
MM_ICONHAND：一个停止消息图标出现在消息框。<br>
指定下列标志中的一个来显不缺省的按钮：标志的含义如下。<br>
MB_DEFBUTTON1：第一个按钮为缺省按钮。如果MB_DEFBUTTON2，MB_DEFBUTTON3，MB_DEFBUTTON4没有被指定，则MB_DEFBUTTON1为缺省值。<br>
MB_DEFSUTTON2；第二个按钮为缺省按钮。<br>
MB_DEFBUTTON3：第三个按钮为缺省按钮。<br>
MB_DEFBUTTON4：第四个按钮为缺省按钮。<br>
指定下列标志中的一个来显示对话框的形态：标志的含义如卜。<br>
MB_APPLMODAL：在hwnd参数标识的窗口中继续工作以前，用户一定响应消息框。但是，用户可以移动到其他线程的窗口且在这些窗口中工作。根据应用程序中窗口的层次机构，用户则以移动到线程内的其他窗口。所有母消息框的子窗口自动地失效，但是弹出窗口不是这样。如果既没有指定MB_SYSTEMMODAL也没有指定MB_TASKMOOAL，则MB_APPLMODAL为缺省的。<br>
MB_SYSTEMMODAL：除了消息框有WB_EX_TOPMOST类型，MB_APPLMODAL和WS_EX_TOPMOST一样。用系统模态消息框来改变各种各样的用户，主要的损坏错误需要立即注意（例如，内存溢出）。如果不是那些与hwnd联系的窗口，此标志对用户对窗口的相互联系没有影响。<br>
MB_TASKMODAL：如果参数hwnd为NULL，除了所有属于当前线程高层次的窗口足失效的，MB_TASKMODALL和MB_ApPLMODAL一样。当调用应用程序或库没有一个可以得到的窗口句柄时，使用此标志。但仍需要阻止到调用应用程序甲其他窗口的输入而不是搁置其他线程。<br>
另外，可以指定下列标志。<br>
MB_DEFAULT_DESKTOP_ONLy：接收输入的当前桌面一定是一个缺省桌面。否则，函数调用失败。缺省桌面是一个在用户已经纪录且以后应用程序在此上面运行的桌面。<br>
MB_HELP：把一个Help按钮增加到消息框。选择Help按钮或按F1产生一个Help事件。<br>
MB_RIGHT：文本为右调整。<br>
MB_RTLREADING：用在Hebrew和Arabic系统中从右到左的顺序显示消息和大写文本。<br>
MB_SETFOREGROUND：消息框变为前景窗口。在内部系统为消息个调用SetForegrundWindow函数。<br>
MB_TOPMOSI：消息框用WS_EX_TOPMOST窗口类型来创建MB_SERVICE_NOTIFICATION。<br>
Windows NT：调用程序是一个通知事件的用户的服务程序。函数在当前活动桌面上显示一个消息框，即使没有用户登记到计算机。<br>
如果设置了此参数，则hwnd参数一定为NULL。所以消息框可以出现在一个桌面上而不是桌面响应参数hwnd。<br>
对于Windows NT 4.0，MB_SERVICE_NOTIFICATION的值己经改变。对于旧的和新的值，请参见WINUSER。<br>
Windows NT 4.O通过把旧值映射到MessageBox和MessageBoxEx执行中的新值，为先存在的服务程序提供逆兼容。此映射只为有了版本数目的可执行程序而做。<br>
为了建立一个用MB_SERVICE_NOTIFICATION的服务器，且可以在Windows NT 3.X和Window NT 4.0上执行，可有两种选择。在连接时间，指定一个版本数目小于4.0的版本，或在连接时间，指定一个4.0版本。在运行时间，用函数GetVersionEx来检测系统版本，然后在Windows NT 3.X上用MB_SERVICE_NOTIFICATION_NT 3.x来运行和在Windows NT 4.0上用MB_SERVICE_NOTIFICAION来运行。MB_SERVCE_NOTIFICATION_NT3.x（WindowNT）此值响应于为WindowNT3.51的MB_SERVICE_NOTIFICAION<br>
定义的值。<br>
<h3>返回值</h3>如果没有足够的内存来创建消息框，则返回值为零。如果函数调用成功，则返回值为下列对话框返回的菜单项目值中的一个：<br>
IDABORT：Abort 按钮被选中。IDCANCEL：Cancel按钮被选中。IDIGNORE：Ignore按钮被选中。<br>
IDNO：NO按钮被选中。IDOK：OK按钮被选中。IDRETRY：RETRY按钮被选中。<br>
IDYES：YES按钮被选中。<br>
如果一个消息框有一个Cancel按钮，且如果Esc键被按下或Cancel键被选择，则函数返回IDCANCEL值。如果消息框没有Cancel按钮，则按Esc键没有作用。<br>
备注：当创建一个系统模态消息框来表示系统在内存的低端中时，由lpTeXt和lpCaption参数指向的字符串不应该从一个资源文件中取出，因为试图装载此资源可能导致失败。<br>
当一个应用程序调用MessageBox，且为uType参数指定MB_ICONHAND和MB_SYSTEMMODAL标志时，系统不管可用内存为多少，直接显示结果消息框。当这些标志被指定，系统把消息框文本的长度局限于三行。系统不能自动截断要填到消息框的行，但是消息字符串一定含有回车换行，以在合适的位置换行。<br>
如果在对话框出现的的同时创建了消息框，则可使用对话框的句柄作为hwnd参数，hwnd参数不应该标识一个子窗口，例如对话框中的一个控制。<br>
Windows 95：系统可以支持最大达16364个窗口句柄。<br>
Windows CE:Windows CE 不支持uType参数的下列值：<br>
MB_STSTEMMODAL；MB_TASKMODAL；MB_HELP；MB_RTLREADING;MB_DEFAULT_DESKTOP_ONLY；<br>
MB_SERVICE_NOTIFICATION；MB_USERICON。<br>
不支持下列<h3>返回值</h3>IDCLOSE；IDHELP。<br>
<h3>速查</h3>Windows：3.1及以上版本：Windows：95及以上版本；Windows：1.0及以上版本;头文件：Winuser.h;库文件：USer32.lib；URicode：在Windows NT上实现为Unicode和ANSI两种版本。<br>

</body>
</html>
