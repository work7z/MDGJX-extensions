(window.saladictEntry=window.saladictEntry||[]).push([[8],{1:function(e,t,s){"use strict";s.d(t,"c",(function(){return d})),s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return u}));var r=s(76),n=s(38),i=s(10);const a=()=>{},o=new WeakMap,c=new WeakMap,h=new WeakMap,d={sync:{clear:g,remove:f,get:p,set:w,addListener:_,removeListener:v,createStream:m,get __storageArea__(){return"sync"}},local:{clear:g,remove:f,get:p,set:w,addListener:_,removeListener:v,createStream:m,get __storageArea__(){return"local"}},clear:g,addListener:_,removeListener:v,createStream:m,get __storageArea__(){return"all"}},l={send:L,addListener:y,removeListener:b,createStream:S,get __self__(){return!1},self:{initClient:T,initServer:function(){window.pageId="background page";const e=/^\[\[(.+)\]\]$/;browser.runtime.onMessage.addListener((t,s)=>{if(!t||!t.type)return;if("PAGE_INFO"===t.type)return Promise.resolve(function(e){const t={pageId:"",faviconURL:"",pageTitle:"",pageURL:""},s=e.tab;s?(t.pageId=s.id||"",s.favIconUrl&&(t.faviconURL=s.favIconUrl),s.url&&(t.pageURL=s.url),s.title&&(t.pageTitle=s.title)):(t.pageId="popup",e.url&&!e.url.startsWith("http")&&(t.faviconURL="https://saladict.crimx.com/favicon.ico"));return t}(s));const r=e.exec(t.type);if(r){t.type=r[1];const e=s.tab&&s.tab.id;return e?L(e,t):L(t)}})},send:async function(e){!1;void 0===window.pageId&&await T();return browser.runtime.sendMessage(Object.assign({},e,{__pageId__:window.pageId,type:`[[${e.type}]]`})).catch(e=>{!1})},addListener:y,removeListener:b,createStream:S,get __self__(){return!0}}};async function u(e,t){const s="string"==typeof e?{url:e,self:t}:e,r=!1!==s.unique,n=s.self?browser.runtime.getURL(s.url):s.url;if(r){const e=await browser.tabs.query({url:n}).catch(()=>[]);if(e.length>0){const{index:t,windowId:s}=e[0];return"function"==typeof browser.tabs.highlight&&await browser.tabs.highlight({tabs:t,windowId:s}),void await browser.windows.update(s,{focused:!0})}}await browser.tabs.create({url:n,active:!1!==s.active})}function g(){return"all"===this.__storageArea__?Promise.all([browser.storage.local.clear(),browser.storage.sync.clear()]).then(a):browser.storage[this.__storageArea__].clear()}function f(e){return browser.storage[this.__storageArea__].remove(e)}function p(...e){return browser.storage[this.__storageArea__].get(...e)}function w(e){return browser.storage[this.__storageArea__].set(e)}function _(...e){let t,s;if("function"==typeof e[0])t="",s=e[0];else{if("string"!=typeof e[0]||"function"!=typeof e[1])throw new Error("wrong arguments type");t=e[0],s=e[1]}let r=h.get(s);r||(r=new Map,h.set(s,r));const n=this.__storageArea__+t;let i=r.get(n);return i||(i=(e,r)=>{"all"!==this.__storageArea__&&r!==this.__storageArea__||t&&!(t in e)||s(e,r)},r.set(n,i)),browser.storage.onChanged.addListener(i)}function v(...e){let t,s;if("function"==typeof e[0])t="",s=e[0];else{if("string"!=typeof e[0]||"function"!=typeof e[1])throw new Error("wrong arguments type");t=e[0],s=e[1]}const r=h.get(s);if(r){if(!t)return r.forEach(e=>{browser.storage.onChanged.removeListener(e)}),void h.delete(s);{const e=this.__storageArea__+t,n=r.get(e);if(n)return browser.storage.onChanged.removeListener(n),r.delete(e),void(r.size<=0&&h.delete(s))}}browser.storage.onChanged.removeListener(s)}function m(e){if(!e)throw new Error("Missing key");return Object(r.a)(t=>this.addListener(e,t),t=>this.removeListener(e,t)).pipe(Object(n.a)(t=>Object.prototype.hasOwnProperty.call(Array.isArray(t)?t[0]:t,e)),Object(i.a)(t=>Array.isArray(t)?t[0][e]:t[e]))}function L(...e){return(1===e.length?browser.runtime.sendMessage(e[0]):browser.tabs.sendMessage(e[0],e[1])).catch(e=>{!1})}function y(...e){void 0===window.pageId&&T();const t=this.__self__?c:o,s=1===e.length?void 0:e[0],r=1===e.length?e[0]:e[1];let n=t.get(r);n||(n=new Map,t.set(r,n));let i=n.get(s||"__DEFAULT_MSGTYPE__");return i||(i=(e,t)=>{if(e&&(this.__self__?window.pageId===e.__pageId__:!e.__pageId__)&&(null==s||e.type===s))return r(e,t)},n.set(s||"__DEFAULT_MSGTYPE__",i)),browser.runtime.onMessage.addListener(i)}function b(...e){const t=this.__self__?c:o,s=1===e.length?void 0:e[0],r=1===e.length?e[0]:e[1],n=t.get(r);if(n){if(!s)return n.forEach(e=>browser.runtime.onMessage.removeListener(e)),void t.delete(r);{const e=n.get(s);if(e)return browser.runtime.onMessage.removeListener(e),n.delete(s),void(n.size<=0&&t.delete(r))}}browser.runtime.onMessage.removeListener(r)}function S(e){return(e?Object(r.a)(t=>this.addListener(e,t),t=>this.removeListener(e,t)):Object(r.a)(e=>this.addListener(e),e=>this.removeListener(e))).pipe(Object(i.a)(e=>Array.isArray(e)?e[0]:e))}function T(){return void 0===window.pageId?l.send({type:"PAGE_INFO"}).then(({pageId:e,faviconURL:t,pageTitle:s,pageURL:r})=>(window.pageId=e,window.faviconURL=t,s&&(window.pageTitle=s),r&&(window.pageURL=r),e)):Promise.resolve(window.pageId)}},1306:function(e,t,s){e.exports=s(1317)},1309:function(e,t,s){},1317:function(e,t,s){"use strict";s.r(t);var r=s(0),n=s.n(r),i=s(20),a=s.n(i),o=s(4),c=s.n(o),h=s(958),d=s.n(h),l=s(959),u=s.n(l),g=s(960),f=s.n(g),p=s(1),w=s(2),_=s(759);class v extends r.PureComponent{constructor(...e){super(...e),this.containerRef=r.createRef(),this.wavesurfer=void 0,this.region=void 0,this.soundTouch=void 0,this.soundTouchNode=void 0,this.shouldSTSync=!1,this.playOnLoad=!0,this.src=void 0,this.state={isPlaying:!1,speed:1,loop:!1,pitchStretch:!w.c},this.initSoundTouch=e=>{const t=e.backend.buffer,s=t.length,r=t.getChannelData(0),n=t.numberOfChannels>1?t.getChannelData(1):r;let i=0;const a={extract:(t,a,o)=>{this.shouldSTSync&&(i=~~(e.backend.getPlayedPercents()*s)-o,this.shouldSTSync=!1),o+=i;for(let e=0;e<a;e++)t[2*e]=r[e+o],t[2*e+1]=n[e+o];return Math.min(a,s-o)}};this.soundTouch=new _.b(e.backend.ac.sampleRate),this.soundTouchNode=Object(_.c)(e.backend.ac,new _.a(a,this.soundTouch)),e.backend.setFilter(this.soundTouchNode)},this.initWavesurfer=()=>{const e=d.a.create({container:this.containerRef.current,waveColor:"#f9690e",progressColor:"#B71C0C",plugins:[u.a.create()]});this.wavesurfer=e,e.enableDragSelection({}),e.on("region-created",e=>{this.removeRegion(),this.region=e}),e.on("region-update-end",this.play),e.on("region-out",this.onPlayEnd),e.on("seek",()=>{this.isInRegion()||this.removeRegion(),this.shouldSTSync=!0}),e.on("ready",this.onLoad),e.on("finish",this.onPlayEnd)},this.onLoad=()=>{this.playOnLoad&&this.play(),this.playOnLoad=!0},this.play=()=>{this.setState({isPlaying:!0}),this.wavesurfer&&(this.state.pitchStretch&&this.soundTouchNode&&this.wavesurfer.getFilters().length<=0&&this.wavesurfer.backend.setFilter(this.soundTouchNode),this.region&&!this.isInRegion()?this.wavesurfer.play(this.region.start):this.wavesurfer.play()),this.shouldSTSync=!0},this.pause=()=>{this.setState({isPlaying:!1}),this.soundTouchNode&&this.soundTouchNode.disconnect(),this.wavesurfer&&(this.wavesurfer.pause(),this.wavesurfer.backend.disconnectFilters())},this.togglePlay=()=>{this.state.isPlaying?this.pause():this.play()},this.onPlayEnd=()=>{this.state.loop?this.play():this.pause()},this.updateSpeed=e=>{this.setState({speed:e}),e<.1||e>3||(this.wavesurfer&&(this.wavesurfer.setPlaybackRate(e),1!==e&&this.state.pitchStretch&&!this.soundTouch&&this.initSoundTouch(this.wavesurfer),this.soundTouch&&(this.soundTouch.tempo=e)),this.shouldSTSync=!0)},this.toggleLoop=e=>{this.setState({loop:e.currentTarget.checked}),e.currentTarget.checked&&!this.state.isPlaying&&this.play()},this.togglePitchStretch=e=>{this.updatePitchStretch(e.currentTarget.checked),p.c.local.set({waveform_pitch:e.currentTarget.checked})},this.updatePitchStretch=e=>{this.setState({pitchStretch:e}),e?1!==this.state.speed&&this.soundTouchNode&&this.wavesurfer&&this.wavesurfer.getFilters().length<=0&&(this.wavesurfer.backend.setFilter(this.soundTouchNode),this.shouldSTSync=!0):(this.soundTouchNode&&this.soundTouchNode.disconnect(),this.wavesurfer&&this.wavesurfer.backend.disconnectFilters())},this.isInRegion=(e=this.region)=>{if(e&&this.wavesurfer){const t=this.wavesurfer.getCurrentTime();return t>=e.start&&t<=e.end}return!1},this.removeRegion=()=>{this.region&&this.region.remove(),this.region=null},this.reset=()=>{this.removeRegion(),this.updateSpeed(1),this.wavesurfer&&(this.wavesurfer.pause(),this.wavesurfer.empty(),this.wavesurfer.backend.disconnectFilters()),this.soundTouch&&(this.soundTouch.clear(),this.soundTouch.tempo=1),this.soundTouchNode&&this.soundTouchNode.disconnect(),this.soundTouch=null,this.soundTouchNode=null,this.shouldSTSync=!1},this.load=e=>{e?(this.wavesurfer?this.reset():this.initWavesurfer(),this.wavesurfer&&(this.wavesurfer.load(e),"suspended"===this.wavesurfer.backend.ac.state&&this.playOnLoad&&new Audio(e).play())):this.reset()}}async componentDidMount(){p.a.self.addListener("PLAY_AUDIO",async({payload:e})=>{this.load(e)}),p.a.self.send({type:"LAST_PLAY_AUDIO"}).then(e=>{e&&e.src&&e.timestamp-Date.now()<1e4?this.load(e.src):(this.playOnLoad=!1,this.load("https://fanyi.sogou.com/reventondc/synthesis?text=Nothing%20to%20play&speed=1&lang=en&from=translateweb"))}),p.c.local.get("waveform_pitch").then(({waveform_pitch:e})=>{null!=e&&this.updatePitchStretch(Boolean(e))})}componentWillUnmount(){this.reset(),this.wavesurfer&&(this.wavesurfer.destroy(),this.wavesurfer=null)}render(){return r.createElement("div",{className:c()({darkMode:this.props.darkMode})},r.createElement("div",{className:"saladict-waveformWrap saladict-theme"},r.createElement("div",{ref:this.containerRef}),r.createElement("div",{className:"saladict-waveformCtrl"},r.createElement("button",{type:"button",className:"saladict-waveformPlay",title:"Play/Pause",onClick:this.togglePlay},r.createElement("div",{className:"saladict-waveformPlay_FG"+(this.state.isPlaying?" isPlaying":"")})),r.createElement(f.a,{className:"saladict-waveformSpeed",title:"Speed",value:this.state.speed,min:.1,max:3,step:.005,decimals:3,onValueChange:this.updateSpeed}),r.createElement("label",{className:"saladict-waveformBtn_label",title:"Loop"},this.state.loop?r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"var(--color-font)"},r.createElement("path",{d:"M23.242 388.417l162.59 120.596v-74.925h300.281l-.297-240.358-89.555-.239-.44 150.801H185.832l.81-75.934-163.4 120.06z"}),r.createElement("path",{d:"M490.884 120.747L328.294.15l.001 74.925H28.013l.297 240.358 89.555.239.44-150.801h209.99l-.81 75.934 163.4-120.06z"})):r.createElement("svg",{viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg",fill:"var(--color-divider)"},r.createElement("path",{d:"M 23.242 388.417 L 23.243 388.417 L 23.242 388.418 Z M 23.243 388.418 L 186.642 268.358 L 185.832 344.292 L 283.967 344.292 L 331.712 434.088 L 185.832 434.088 L 185.832 509.013 Z M 395.821 344.292 L 396.261 193.491 L 485.816 193.73 L 486.113 434.088 L 388.064 434.088 L 340.319 344.292 Z"}),r.createElement("path",{d:"M 490.884 120.747 L 490.883 120.746 L 490.885 120.745 Z M 490.883 120.746 L 327.485 240.805 L 328.295 164.871 L 244.267 164.871 L 196.521 75.075 L 328.295 75.075 L 328.294 0.15 Z M 118.305 164.871 L 117.865 315.672 L 28.31 315.433 L 28.013 75.075 L 141.077 75.075 L 188.823 164.871 Z"}),r.createElement("rect",{x:"525.825",y:"9.264",width:"45.879",height:"644.398",transform:"matrix(0.882947, -0.469472, 0.469472, 0.882947, -403.998657, 225.106232)"})),r.createElement("input",{type:"checkbox",checked:this.state.loop,onChange:this.toggleLoop})),!w.c&&r.createElement("label",{className:"saladict-waveformPitch saladict-waveformBtn_label",title:"Pitch Stretch"},r.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 467.987 467.987",fill:this.state.pitchStretch?"var(--color-font)":"var(--color-divider)"},r.createElement("path",{d:"M70.01 146.717h47.924V321.27H70.01zM210.032 146.717h47.924V321.27h-47.924zM350.053 146.717h47.924V321.27h-47.924zM0 196.717h47.924v74.553H0zM280.042 196.717h47.924v74.553h-47.924zM420.063 196.717h47.924v74.553h-47.924zM140.021 96.717h47.924V371.27h-47.924z"})),r.createElement("input",{type:"checkbox",checked:this.state.pitchStretch,onChange:this.togglePitchStretch})))))}}var m=v;s(1309);const L=new URL(document.URL).searchParams,y=Boolean(L.get("darkmode"));a.a.render(n.a.createElement(m,{darkMode:y}),document.getElementById("root"))},2:function(e,t,s){"use strict";s.d(t,"f",(function(){return r})),s.d(t,"h",(function(){return n})),s.d(t,"j",(function(){return i})),s.d(t,"i",(function(){return a})),s.d(t,"k",(function(){return o})),s.d(t,"l",(function(){return c})),s.d(t,"a",(function(){return h})),s.d(t,"b",(function(){return d})),s.d(t,"c",(function(){return l})),s.d(t,"g",(function(){return u})),s.d(t,"e",(function(){return g})),s.d(t,"d",(function(){return f}));const r=()=>!!window.__SALADICT_INTERNAL_PAGE__,n=()=>!!window.__SALADICT_OPTIONS_PAGE__,i=()=>!!window.__SALADICT_POPUP_PAGE__,a=()=>!!window.__SALADICT_PDF_PAGE__,o=()=>!!window.__SALADICT_QUICK_SEARCH_PAGE__,c=()=>i()||o(),h="saladict-external",d="saladict-panel",l=navigator.userAgent.includes("Firefox"),u=navigator.userAgent.includes("OPR");function g(e){if(!e)return!1;for(let t=e;t;t=t.parentElement)if(t.classList&&t.classList.contains(h))return!0;return!1}function f(e){if(!e)return!1;for(let t=e;t;t=t.parentElement)if(t.classList&&t.classList.contains(d))return!0;return!1}}},[[1306,0,1,24]]]);